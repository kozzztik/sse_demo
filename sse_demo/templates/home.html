<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="author" content="http://vk.com/kozzztik" />
        <title>SSE Demo</title>

        <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}common/bootstrap.min.css" />
        <link type="text/css" rel="stylesheet" href="{{ STATIC_URL }}common/bootstrap-vue.min.css" />

        <script type="text/javascript" src="{{ STATIC_URL }}common/vue.js"></script>
        <script type="text/javascript" src="{{ STATIC_URL }}common/bootstrap-vue.min.js"></script>
        <script type="text/javascript" src="{{ STATIC_URL }}common/axios.min.js"></script>
    </head>
    <body class="bootstrap4">
        <div id="vue_app">
            <div id="content-center" class="container">
                <h1>Server side events demo</h1>
                <p>You can use /sse endpoint for listening events and form to
                send them.
                </p>
                <p>Also you can POST to /sse events manualy. Body format is
                    {"name": "event_name", "data": "event_data"}</p>
                <form class="form-inline"  @submit.prevent="send_message">
                    <label class="mr-sm-2" for="name">Name</label>
                    <input id="name" class="form-control"  v-model="name">
                    <label class="mr-sm-2" for="message_text">Text</label>
                    <input id="message_text" class="form-control"  v-model="message_text">
                    <button class="btn btn-primary mb-2">Send</button>
                </form>
                <h3>Events in channel</h3>
                <p>Note that messages will be shown only if their type is "message".</p>
                <table class="table">
                  <thead class="thead-dark">
                    <tr>
                      <th scope="col">#</th>
                      <th scope="col">Name</th>
                      <th scope="col">data</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="item in messages">
                        <td v-html="item.id"></td>
                        <td v-html="item.name"></td>
                        <td v-html="item.data"></td>
                    </tr>
                  </tbody>
                </table>
            </div>
            <script type="module" src="{{ STATIC_URL }}app.js"></script>
        </div>
    </body>
</html>
